### 요약

- 인코딩 - 하나의 데이터가 층을 내려가며 여러 데이터로 감싸진다
- 디코딩 - 감싸진 데이터는 층을 올라가며 하나씩 해석된다 (디코딩)

### 계층을 나누는 이유

- 표준화 → 포트, 프로토콜 문제를 해결하여 비용 절감
- 모듈화 → 계층별 기능과 통신 과정을 나누어 쉽게 알 수 있음
- 유지보수 → 특정 층에 이상이 생기면 그 층만 수리하면 됨

![image](https://user-images.githubusercontent.com/43740455/137590719-52e1930c-572f-4b59-9cf3-30ff7ac3d3d5.png)

- 현대의 계층은 TCP/IP Updated 계층으로 4단계로 간소화
- SW 아키텍처 중 Layered 아키텍처의 대표적 예시

### 1. 물리 (Physical)

- 인코딩 : 비트 단위의 데이터를 아날로그 전기 신호로 바꿔 전선으로 보냄
- 디코딩 : 아날로그 신호를 비트 데이터로 해석
- 데이터만 전달할뿐, 무슨 데이터, 어떤 에러가 있는지 전혀 신경 안씀
- 장비
    - 리피터
    - 허브
    

### 2. 데이터 링크 (Data Link)

- 전선 하나로 여러 대의 컴퓨터와 통신할 방법
- 오류제어 흐름제어를 담당

### 주요 장비

1. **Bridge**
    - 네트워크 세그먼트를 연결해주는 장치
        - 네트워크 세그먼트 → 큰 네트워크를 구성하는 작은 네트워크 단위
    - 기능
        - Learning
            - 데이터의 MAC 주소를 브릿지의 MAC 주소 테이블에 저장함
            - 이후 다른 호스트에서 데이터에 접근하면 테이블을 참고해 **전송 여부** 결정
        - Flooding
            - 목적지 정보가 MAC 주소 테이블에 없다면 **모든 포트**로 같은 데이터 전송
        - Forwarding
            - 목적지 정보가 MAC 주소 테이블에 있다면 **해당 포트**로 데이터 전송
        - Filtering
            - 브릿지를 건너지 못하게 하는 기능
            - 같은 세그먼트에 있는 호스트끼리만 통신하게 만듦
            - 외부 호스트로의 통로 차단
        - Aging
            - 300초가 지나도록 해당 MAC 주소로 프레임이 들어오지 않으면 테이블에서 삭제
            
        - MAC 주소
            - 무선 LAN 카드, 무선 LAN 내장 기기에 개별적으로 부여되는 식별 번호
                - 16진수 12자리 (ex: 12:34:56:78:90:AB)
            - OS에 따라 물리적 주소 또는 Wi-Fi 주소 라고 표시
            
2. **Switch**
    - 동일 네트워크 내에서의 전송을 담당
    - 전선에 연결된 모든 컴퓨터가 중 정확한 목적지에만 데이터를 보내는 장비
    - 브릿지(소프트웨어)와 달리 하드웨어 방식(브릿지 :
    - 브릿지의 상위 호환 - 더 빠름, 포트 수 많음 (브릿지는 현재 잘 사용 X)
    
    - 종류
        - L2 스위치
            - MAC 주소 기반으로 패킷을 전달
        - L3 스위치
            - L2 스위치 + 라우팅 기능
            - IP 정보를 보고 스위칭
            - 하드웨어 방식이라 라우터보다 훨씬 빠른 장점
        - L4 스위치
            - 4계층 프로토콜인 TCP/UDP를 이용
            - 부하 부산 기능을 제공 → 대량 트래픽을 여러 서버로 분산
        - L7 스위치
            - L4 스위치 + 페이로드 분석
            - Dos나 SYN Attack에 대한 방어가 가능
                - SYN Attack → 모든 서버 자원을 소비하여 서버 사용 불가능하게 만듦

### 주요 기능

1. **Framing**
    - 데이터그램을 프레임으로 캡슐화
        - 데이터그램
            
            ![image](https://user-images.githubusercontent.com/43740455/137590733-9a2b11c9-5733-47ee-904f-271fe3603638.png)
            
            - 데이터그램 = 헤더(20~60byte) + 데이터 로 구성된 가변길이
            - 헤더 구성
                - VER → IP 버전을 나타내는 영역
                - HLEN → 헤더 크기를 규정
                - DS → 차별화된 서비스. 데이터마다 우선권 부여
                - 전체 길이 → 데이터그램의 총 길이
                - 데이터그램 식별자 → 이 패킷이 어떤 원본 데이터그램에서 왔는지 알 수 있음
                - 플래그 → 패킷의 분할 여부
                - 패킷분할 옵셋 → 8바이트로 조각난 패킷의 부분을 가리키는데 사용
                - TTL → 존재시간 영역. 목적지에 도착하지 못한 패킷은 네트워크에 계속 남아 자원을 소비. TTL 값이 0이면 라우터는 그 패킷을 패기
                - 프로토콜 → 상위 계층 프로토콜을 정의
                - 헤드체크섬 → 패킷 전송 중 에러 검출을 위해 사용
                - 전송, 목적지 IP주소 → 32비트
            
        - 프레임
            - 데이터 그램을 **캡슐화** → 헤더와 트레일러를 붙여서
            - 프레임 헤더엔 **MAC 주소**가 담김
            - 종류
                - IEEE 802.3 → 초기 버전
                - IEEE 802.3 (이더넷) → 개정 버전
                
                ![image](https://user-images.githubusercontent.com/43740455/137590741-51e4019c-fb66-4397-a745-9ba81185989c.png)
                

1. Link Access
2. 신뢰적 전달
    - 오류율 낮은 링크엔 쓰이지 않음(광섬유, UTP)
    - 오류율 높은 링크에 쓰임 (무선 링크..)
3. 흐름 제어
    - 수신 노드의 수신 속도에 맞게 흐름 제어
4. 오류 검출
    - 수신 노드에서 오류 검출하여 송신자에게 재전송 신호를 보내거나 프레임 버림
5. 오류 정정
    - 수신 노드에서 오류 검출하여 재전송 보내지 않고 비트 오류를 수정
6. 반이중/전이중 전송
    - 반이중 전송 → 한 노드가 동시에 송수신 처리 불가
    - 전이중 전송 → 링크 양단의 노드가 동시에 패킷을 전송

### 오류 검출 및 정정 기술

- 오류 검출 및 정정 비트를 추가한다

![image](https://user-images.githubusercontent.com/43740455/137590773-0855f201-f5f2-4fe4-aa6d-f8f25bf10269.png)

- 종류
    - 패리티 검사
    - 인터넷 체크섬
    - 순환중복검사(CRC, Cycle Redundancy Check)

### 3. 네트워크 (Network)

- 서로 다른 두 네트워크간 전송 담당
    - 라우팅 - 데이터를 목적지까지 안전하고 빠르게 전달
    - 포워딩 : 라우터는 도착지를 바로 알 수 없을 땐 상위 라우터에게 전달하게 됨
- IP계층
    - IP 패킷의 전달 및 라우팅 담당
        - 패킷 : 데이터 앞에 IP 주소를 붙인 것
    - 프로토콜
        - IP → 패킷의 전달을 책임
        - ICMP → 패킷 전달 에러의 보고 및 진단
- 장비
    - 라우터 : 네트워크끼리의 통신을 가능하게 해줌. 라우터끼리 연결도 가능
    

### 4. 전송 (Transport)

- 포트를 통해 데이터를 받고자 하는 프로세스에 전달하는 행위
    - 프로세스는 고유한 포트번호를 가지고 있어야 함
- 세그멘테이션, 흐름제어, 오류제어 등을 제공
    - 세그멘테이션 - 상위 계층 데이터를 세그먼트 단위로 나눔
    - 오류 제어 - 보낸 데이터에 오류 손실이 있는지 검증
- 양 끝단(End to end) 사용자들이 신뢰성 있는 데이터를 주고 받게 함
    - 상위 계층에서 데이터 전달의 유효성이나 효율성을 생각하지 않도록 해줌
- 프로토콜
    - TCP → 신뢰적인 전송을 보장
        - 패킷 손실, 중복, 순서 바뀜이 없도록 보장
    - UDP → TCP에 비해 신뢰성이 낮음
        - 비연결성, 신뢰성이 없음, 순서화되지 않은 Datagram 서비스
        - 실시간 응용 및 멀티캐스팅
        - 단순한 헤더
        

### 5. 세션 (Session)

- 데이터가 통신하기 위한 논리적인 연결층

### 6. 표현 (Presentation)

- 서로 다른 응용 프로세스의 독립성을 제공, 암호화
- 코드 간의 번역을 담당
    - ex: EBCDIC로 인코딩 된 문서를 ASCII 파일로 변환
    - ex: 해당 데이터가 TEXT, GIF, JPG인지 구분

### 7. 응용 (Application)

- 모든 통신의 목적지
- 응용 프로세스를 직접 사용하여 응용 서비스를 수행
- 프로토콜 종류
    - HTTP : 웹 서버 및 브라우저 상호 간의 데이터 전송을 위한 응용계층 프로토콜
    - FTP
    - SMTP
