# 정규화 (Normalization)

1. 정규화란?

   - 데이터베이스의 테이블이 잘 만들어졌는지 평가 + 수정
   - 논리적 설계 단계에서 실행

   - 정규화의 필요성 : **데이터의 중복 해소** -> 이상현상(삽입, 삭제, 수정 이상) 해결

     

2. 정규형(Normal Form) 종류

   - 1NF
   - 2NF
   - 3NF
   - BCNF
   - ...
   - 1NF > 2NF > 3NF > .. > BCNF 이런 식으로 포함관계를 갖는다. (따라서 BCNF형은 제1,2,3 정규형을 만족)



- 1NF

  모든 속성은 **반드시 하나의 값**만 가져야 한다. (Atomic Columns)

  ex) PK: Customer ID

  | Customer  ID | First  Name | Last  Name | Telephone  Number             |
  | ------------ | ----------- | ---------- | ----------------------------- |
  | 1            | A           | Kim        | 010-000-0000,    010-000-0001 |
  | 2            | B           | Lee        | 010-111-1111                  |
  | 3            | C           | Hong       | 010-222-1111                  |
  | 4            | D           | Park       | 010-333-1111                  |
  | 5            | E           | Son        | 010-444-1111                  |

  전화번호가 여러개인 사람이 있다고 할 때, 밑의 2개의 표로 분리해서 모든 속성이 하나의 값을 가지도록 만들 수 있다.

  | **Customer  ID** | First  Name | Last  Name |
  | ---------------- | ----------- | ---------- |
  | 1                | A           | Kim        |
  | 2                | B           | Lee        |
  | 3                | C           | Hong       |
  | 4                | D           | Park       |
  | 5                | E           | Son        |

  | Id   | Customer  Id | Telephone  Number |
  | ---- | ------------ | ----------------- |
  | 1    | 1            | 010-000-0000      |
  | 2    | 1            | 010-000-0001      |
  | 3    | 2            | 010-111-1111      |
  | 4    | 3            | 010-222-1111      |
  | 5    | 4            | 010-333-1111      |
  | 6    | 5            | 010-444-1111      |

  

- 2NF

  **부분 종속성**이 없어야 한다. (No partial dependencies)

  ex) PK: Id, Lecture

  | **Id** | **Lecture** | Room | Grade |
  | ------ | ----------- | ---- | ----- |
  | 111    | DB          | R100 | 4.0   |
  | 222    | DB          | R100 | 4.0   |
  | 333    | OS          | R200 | 4.0   |
  | 444    | OS          | R200 | 4.0   |
  | 555    | Network     | R300 | 4.0   |

  Lecture 속성이 Room에 포함되므로, 부분 종속성을 제거하기 위해 2개의 표로 나눈다.

  | **Id** | **Lecture** | Grade |
  | ------ | ----------- | ----- |
  | 111    | DB          | 4.0   |
  | 222    | DB          | 4.0   |
  | 333    | OS          | 4.0   |
  | 444    | OS          | 4.0   |
  | 555    | Network     | 4.0   |

  | **Lecture** | Room |
  | ----------- | ---- |
  | DB          | R100 |
  | OS          | R200 |
  | Network     | R300 |

  

- 3NF

  **기본키가 아닌 모든 속성** 간에는 서로 종속될 수 없다.

  ex) PK: Id

  | **Id** | Name | Email         | Department | Major      |
  | ------ | ---- | ------------- | ---------- | ---------- |
  | 111    | Tom  | tom@naver.com | 이과대학   | 물리       |
  | 222    | Dan  | dan@naver.com | 문과대     | 경제       |
  | 333    | Jin  | jin@naver.com | 문과대     | 경영       |
  | 444    | Kim  | kim@naver.com | 공대       | 컴퓨터공학 |
  | 555    | Lee  | lee@naver.com | 이과대학   | 수학       |

  기본키는 id이고, 전공(Major)이 학부(Department)에 포함되므로 표를 나누어 종속성을 해결할 수 있다.

  | **Id** | Name | Email         | Major(FK)  |
  | ------ | ---- | ------------- | ---------- |
  | 111    | Tom  | tom@naver.com | 물리       |
  | 222    | Dan  | dan@naver.com | 경제       |
  | 333    | Jin  | jin@naver.com | 경영       |
  | 444    | Kim  | kim@naver.com | 컴퓨터공학 |
  | 555    | Lee  | lee@naver.com | 수학       |

  | Major      | Department |
  | ---------- | ---------- |
  | 물리       | 이과대학   |
  | 수학       | 이과대학   |
  | 경영       | 문과대     |
  | 경제       | 문과대     |
  | 컴퓨터공학 | 공대       |



3. 정규화의 장점
   - 데이터베이스에서 삽입, 삭제, 수정이 쉬워짐
   - 새로운 종류의 데이터 추가할 때 전체적인 구조 수정 필요가 사라짐
   - 구조를 단순화하여 데이터 중복 감소(데이터 사용량 감소), 직관적인 이해도도 올라감



4. 정규화의 단점

   - 릴레이션의 분해로 인해 필요에 따라 JOIN 연산이 많아질 수 있다. JOIN 연산의 경우 시간이 오래걸리기 때문에 성능 저하가 나타날 수 있음

   - 즉, **쓰기의 편리함**을 위해 **읽기의 성능을 희생**하는 것
   - 조회를 하는 SQL 문장에서 JOIN이 많이 발생하는 경우에 성능저하가 나타날 수 있고, 이를 해결하기 위한 방법으로는 **역정규화(반정규화)** 방법이 있음.



5. 역정규화(Denormalization)
   - 정규화된 표를 성능/개발 편의성을 위해서 조작
   - 데이터 무결성이 보장되지 않으므로 제한적으로 사용함
   - ex) 자주 사용하는 데이터를 따로 빼서 저장
   - ex) 데이터의 통계 자료 등을 미리 계산해서 새로운 표로 저장해놓는 것